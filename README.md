# 语法分析器比较工具

## 项目概述

本项目是一个用于比较不同语法分析器（Parser）性能的工具，重点测试 LL(1)、LR(0)、SLR(1)、LR(1) 和 LALR(1) 分析器的解析效率和成功率。项目通过生成随机测试用例，基于给定的文法，运行各种分析器并记录其执行时间和成功率，以进行性能比较。

## 功能特点

- **支持多种分析器**：包括 LL(1)、LR(0)、SLR(1)、LR(1) 和 LALR(1) 分析器。
- **随机测试用例生成**：根据指定文法和深度，生成随机的测试表达式。
- **性能评估**：记录每个分析器的平均执行时间和解析成功率。
- **文法支持**：支持基于上下文无关文法的表达式解析，包含基本表达式文法和增强文法。
- **结果输出**：以清晰的表格形式展示比较结果，并提供详细的执行时间数据。

## 项目结构

项目包含以下主要模块：

- **Grammar.py**：定义文法类，管理产生式、终结符、非终结符和开始符号。
- **LL1Parser.py**：实现 LL(1) 分析器，支持基于 FIRST 和 FOLLOW 集合的预测分析表构建。
- **LR0Item.py**：实现 LR(0) 项目（Item）和 LR(0) 分析器，支持状态机的构建和解析。
- **SLR1Parser.py**：实现 SLR(1) 分析器，扩展 LR(0) 分析器，加入 FOLLOW 集合以减少冲突。
- **LR1Item.py**：实现 LR(1) 项目，支持带向前看符号的状态机构建。
- **LALR1Parser.py**：实现 LALR(1) 分析器，通过合并 LR(1) 状态机中的核心项目来优化性能。
- **ParserTester.py**：主测试类，负责文法创建、测试用例生成、分析器运行和结果输出。

## 安装与依赖

本项目基于 Python 实现，需要以下依赖：

- Python 3.6+
- 标准库模块：`time`、`random`、`collections`

无需额外安装第三方库，直接克隆项目并运行即可。

## 使用方法

1. **准备工作**：
   确保项目目录中包含所有必要的 Python 文件（`Grammar.py`, `LL1Parser.py`, `LR0Item.py`, `SLR1Parser.py`, `LR1Item.py`, `LALR1Parser.py`, `ParserTester.py`）。

2. **运行测试**：
   在项目目录下运行 `ParserTester.py`：

   ```bash
   python ParserTester.py
   ```

   默认配置将运行一个小型测试（5 个测试用例，最大深度为 3）。您可以通过修改 `run_comparison` 方法的参数 `num_cases` 和 `max_depth` 来调整测试规模。

3. **输出结果**：
   程序会输出两部分结果：

   - **比较结果**：以表格形式展示每个分析器的平均执行时间（秒）和成功率。
   - **详细时间数据**：列出每个分析器在每个测试用例上的执行时间。

   示例输出：

   ```
   Testing LL(1) parser...
   Testing LR(0) parser...
   Testing SLR(1) parser...
   Testing LR(1) parser...
   Testing LALR(1) parser...
   
   Parser Comparison Results:
   Parser     Avg Time (s)    Success Rate
   ----------------------------------------
   LL(1)      0.000123        100.00%
   LR(0)      0.000234        80.00%
   SLR(1)     0.000189        90.00%
   LR(1)      0.000345        100.00%
   LALR(1)    0.000278        100.00%
   
   Detailed Timing Data:
   LL(1) parser timings:
   0.000100, 0.000120, 0.000130, 0.000110, 0.000150
   ...
   ```

## 文法说明

项目中定义了以下三种文法，用于测试不同的分析器：

1. **基本表达式文法**（用于 LR 分析）：

   ```
   E → E + T | T
   T → T * F | F
   F → (E) | id
   ```

2. **增强文法**（为 LR 分析添加起始符号）：

   ```
   E' → E
   E → E + T | T
   T → T * F | F
   F → (E) | id
   ```

3. **LL(1) 文法**（专为 LL(1) 分析器设计）：

   ```
   E → T E'
   E' → + T E' | ε
   T → F T'
   T' → * F T' | ε
   F → (E) | id
   ```

## 测试用例生成

- **生成方式**：通过 `generate_test_cases` 方法随机生成表达式，基于文法规则和指定的最大深度（`max_depth`）。
- 示例用例：
  - `id`
  - `(id + id) * id`
  - `((id) * (id + id))`

## 分析器实现细节

- **LL(1) 分析器**：基于预测分析表，使用 FIRST 和 FOLLOW 集合进行解析，适合无左递归的文法。
- **LR(0) 分析器**：构建 LR(0) 状态机，适合简单的文法，但可能产生移进-归约冲突。
- **SLR(1) 分析器**：在 LR(0) 的基础上使用 FOLLOW 集合改进动作表，减少冲突。
- **LR(1) 分析器**：通过为每个项目添加向前看符号（lookahead），支持更复杂的文法。
- **LALR(1) 分析器**：通过合并 LR(1) 状态机的核心项目，优化空间效率，同时保持较高的解析能力。

## 注意事项

- **文法限制**：确保输入的文法符合对应分析器的要求（例如，LL(1) 文法需无左递归和二义性）。
- **测试规模**：较大的 `num_cases` 和 `max_depth` 会增加运行时间，建议根据机器性能调整。
- **错误处理**：如果文法不适合某种分析器（例如，非 LR(1) 文法用于 LR(1) 分析器），程序会抛出异常并记录失败。

## 贡献与反馈

欢迎提交问题或改进建议！请通过 GitHub Issues 或 Pull Requests 参与贡献。

## 许可证

本项目采用 MIT 许可证，详情见 `LICENSE` 文件。
